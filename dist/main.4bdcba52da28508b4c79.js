!function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){},function(e,t,i){"use strict";i.r(t);var a=i.p+"imgs/busywork.c8b68bdfbe524d73211081b9f13b0eef.svg",n=i.p+"imgs/charity.f15fc99644f13ad53879b4dfb5becf43.svg",s=i.p+"imgs/relaxation.fa1d5b6ddaf8b2511448a31a9ccfb08a.svg",c=i.p+"imgs/music.b7f3ce702efdb2d3c4baad72c5de3a92.svg",r=i.p+"imgs/social.90bbe0d86e1f00fd0666b954dd53983f.svg",l=i.p+"imgs/recreational.e584a76941cc7b156c5c7388892bc78c.svg",o=i.p+"imgs/diy.248c51205a09e739ca9975bf11621043.svg",d=i.p+"imgs/cooking.2059d863b5c2579c8fa31f243bbd0c54.svg",u=i.p+"imgs/education.b122915a224fb51bfa096624bb1a7de6.svg",h=i.p+"imgs/like-true.b61d119b5f76819c52f9d490178ad7cb.svg",p=i.p+"imgs/like-false.b00967356831f3bdc7c4529dc420ee5e.svg";const y={nav:document.querySelector("#nav"),menu:document.querySelector("#menu"),likes:document.querySelector("#likes"),activitySection:document.querySelector("#section1"),main:document.querySelector("#main"),likeToggle:document.querySelector("#like"),body:document.querySelector("#body"),whenSignedIn:document.getElementById("whenSignedIn"),whenSignedOut:document.getElementById("whenSignedOut"),signInBtn:document.getElementById("signInBtn"),signOutBtn:document.getElementById("signOutBtn"),userDetails:document.getElementById("userDetails"),createAct:document.getElementById("createAct"),actsList:document.getElementById("actsList"),newAct:document.getElementById("newAct")},k=e=>{let t;return t=e?h:p,t},m=e=>{let t;switch(e){case"busywork":t=a;break;case"charity":t=n;break;case"cooking":t=d;break;case"diy":t=o;break;case"education":t=u;break;case"music":t=c;break;case"recreational":t=l;break;case"relaxation":t=s;break;case"social":t=r;break;default:t=""}return t},g=e=>{e.insertAdjacentHTML("afterend",'\n    <svg id="loader" class="animate-spin my-10 mx-auto h-16 w-16 text-center text-primary-200" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n    <circle class="opacity-50" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n  </svg> \n    ')},f=()=>{const e=document.querySelector("#loader");e&&e.parentElement.removeChild(e)};class b{constructor(e="",t){this.key=e,this.data=t}async getResults(){if(null==this.data)try{const e=await fetch("http://www.boredapi.com/api/activity?key="+this.key).then(e=>e.json());return this.title=e.activity,this.type=e.type,this.people=e.participants,this.price=e.price,this.link=e.link,this.access=e.accessibility,this.liked=!1,this.key=e.key,e}catch(e){console.error(e)}else this.title=this.data.title,this.type=this.data.type,this.people=this.data.people,this.price=this.data.price,this.link=this.data.link,this.access=this.data.access,this.liked=!!this.data.liked}}const v=firebase.firestore();class w{constructor(e){this.key=e}async getData(){const e=v.collection("activities").doc(""+this.key);try{const t=await e.get();return!!t.exists&&(this.data=t.data(),!0)}catch(e){return!1}}async updateLike(e){const t=v.collection("activities").doc(""+this.key);try{const i=await t.get();if(!i.exists)return!1;if(e)try{return await t.update({liked:i.data().liked+1}),!0}catch(e){return!1}else try{return await t.update({liked:i.data().liked-1}),!0}catch(e){return!1}}catch(e){return!1}}}class x{constructor(){this.likes=[]}addLike(e,t,i){const a={key:parseInt(e),title:t,type:i};return this.likes.push(a),this.persistData(),!0}deleteLike(e){const t=this.likes.findIndex(t=>t.key==e);return this.likes.splice(t,1),this.persistData(),!1}isLiked(e){return-1!==this.likes.findIndex(t=>t.key==e)}getLast(){return this.likes.length-1}persistData(){localStorage.setItem("likes",JSON.stringify(this.likes))}readStorage(){const e=JSON.parse(localStorage.getItem("likes"));e&&(this.likes=e)}}var S=i.p+"imgs/accesibility.68297b7bb8ebee64505429075ba45d46.svg",L=i.p+"imgs/price.369be4ac1120b25a6879b355281e713e.svg",I=i.p+"imgs/participants.a23b7c7aaece0ba39352ffcc61d60c6a.svg";const A=(e,t)=>{let i;i=null!=e?`     \n                  <div class="flex justify-between items-center ">\n              <h3 class="text-xl font-bold pl-6 capitalize"><a href="#${e.link}">${e.title}</a></h3>\n                  <div class="bg-primary-200 px-6 py-2 cursor-pointer" id="like">\n                      <img class="button hover:scale-110 " src="${k(t)}" alt="" srcset="">\n                  </div>\n              </div>\n              <div class="h-1 bg-primary-200"></div>\n                  <div class="font-semibold flex flex-col md:flex-row justify-evenly items-center p-3">            \n                      <h4>Categoria: <span class="font-bold capitalize">${e.type}</span></h4>\n                      <img src="${m(e.type)}" heigh="48" width="48">\n                      <h4>Participantes: <span class="font-bold">${e.people}</span></h4>\n                      <img src="${I}" heigh="48" width="48">\n                      <h4>Accesibilidad: <span class="font-bold">${Math.round(10*e.access)} / 10</span></h4>\n                      <img src="${S}" heigh="48" width="48">\n                      <h4>Precio: <span class="font-bold">${Math.round(10*e.price)} / 10</span></h4>\n                      <img src="${L}" heigh="48" width="48">\n                  </div>\n      `:null==e&&1==t?'<div class="bg-gray-400 h-full w-full text-center">\n    <h1 class="text-gray-800 font-extrabold p-6">Para activar la funcionalidad de me gustas, debe registrarse</h1>\n  </div>':'<div class="bg-red-700 h-full w-full text-center">\n    <h1 class="text-white font-extrabold p-6">Error: puede deberse a permisos, conexion o falta de data. Intente de vuelta</h1>\n  </div>',y.activitySection.insertAdjacentHTML("afterbegin",i)},E=()=>{y.activitySection.innerHTML=""},$=e=>{const t=`\n            <li>\n              <a href="#${e.key}" class="border-primary-300 border-2 flex flex-row px-6 py-4 justify-evenly">\n                <img src="${m(e.type)}" heigh="48" width="48">\n                <h4 class="text-base p-2">${e.title}</h4>\n              </a>\n            </li>`;y.likes.insertAdjacentHTML("beforeend",t)},B=e=>{if(e){const t=document.querySelector(`a[href*="${e}"]`).parentElement;t&&t.parentElement.removeChild(t)}};i(0);const O={},j=firebase.auth().currentUser,M=firebase.firestore();let P,T,q,D;const C=async(e,t)=>{const i=parseInt(e,10);O.act=new b(i||"",t),E(),f(y.main),g(y.main);try{await O.act.getResults()}catch(e){console.error(e)}if(null!=O.act.title){let e;j?(T=M.collection("users").doc(j.uid),e=await T.get().then(e=>e.data().likes.some(e=>e.key==O.act.key))):e=O.like.isLiked(O.act.key),f(y.main),A(O.act,e)}else E(),f(y.main),A(void 0,!1),console.error("ERROR: Activiy not found, try again"),O.act.liked=O.like.deleteLike(i),B(i)},H=async e=>{if(O.app.key)try{await O.app.updateLike(e)}catch(e){console.error(e)}else console.error("Key not found")},_=firebase.default.auth(),R=new firebase.auth.GoogleAuthProvider;_.onAuthStateChanged(e=>{e?(y.whenSignedIn.hidden=!1,y.whenSignedOut.hidden=!0,y.userDetails.innerHTML=`<h3>Hola <span class=" font-bold"> ${e.displayName}</span>!</h3> <p>ID de Usuario: <span class=" font-bold">${e.uid}</span><br><span>Para hacer <b>sync </b>de tus me gustas ponle me gusta a cualquier actividad!</p>`):(y.whenSignedIn.hidden=!0,y.whenSignedOut.hidden=!1,y.userDetails.innerHTML="")}),_.onAuthStateChanged(e=>{e?(T=M.collection("users").doc(e.uid),T.get().then((function(e){if(e.exists){let t=e.data().likes;T.set({likes:t}),O.like.likes.forEach(e=>B(e.key)),O.like.likes=t,O.like.likes.forEach(e=>$(e))}})).catch((function(e){console.error("Error al buscar documento:",e)})),P=M.collection("activities"),y.createAct.onclick=()=>{if(0!=y.newAct.elements.name.value){const t={key:1000001+D,uid:e.uid,uname:e.displayName,title:y.newAct.elements.name.value,type:y.newAct.elements.type.value,people:parseInt(y.newAct.elements.participants.value),price:y.newAct.elements.price.value/10,access:y.newAct.elements.accesibility.value/10,createdAt:firebase.firestore.FieldValue.serverTimestamp(),link:"",liked:0};C(t.key,t),P.doc(""+t.key).set(t),O.act.liked=O.like.addLike(t.key,t.title,t.type),$(O.act);for(let e=0;e<y.newAct.elements.length;e++)y.newAct.elements[e].value=""}},q=P.orderBy("createdAt").onSnapshot(e=>{D=e.docs.length;const t=e.docs.map(e=>`<li id="like-${e.data().key}"class="list-decimal list-inside flex flex-row items-center m-4 border-primary-200 p-4 border-4 rounded-lg bg-primary-300 text-white"><h4 class="mx-2 text-base"><a href="#${e.data().key}" class="font-bold cursor-pointer">${e.data().title}</a> - agregada por <span class="italic">${e.data().uname}</span></h4><div class="flex flex-col md:flex-row border-primary-200 border-2 rounded-md p-2 bg-primary-300 mx-3 my-0 cursor-pointer ml-auto" >\n\t\t\t\t\t<h4 class="text-3xl mx-2">${e.data().liked}</h4>\n\t\t\t\t\t<img class="button hover:scale-110 mx-2" src="${k(!0)}" alt="" srcset=""></img>\n\t\t\t\t</div></li>`);y.actsList.innerHTML=t.join("")})):(O.app=null,q&&q())}),y.signInBtn.onclick=()=>_.signInWithPopup(R),y.signOutBtn.onclick=()=>{_.signOut(),O.like.likes.forEach(e=>B(e.key)),O.like=new x,window.location.hash="",O.like.readStorage(),O.like.likes.forEach(e=>$(e))},y.nav.addEventListener("click",e=>{e.target.matches("#likesBtn, #likesBtn *")?y.likes.classList.contains("hidden")?y.likes.classList.remove("hidden"):y.likes.classList.add("hidden"):e.target.matches("#burger, #burger *")&&(y.menu.classList.contains("hidden")?y.menu.classList.remove("hidden"):y.menu.classList.add("hidden"))}),y.body.addEventListener("click",e=>{e.target.matches("#like, #like *")?(async()=>{E(),f(y.main),g(y.main),O.like||(O.like=new x),O.like.isLiked(O.act.key)?(O.act.liked=O.like.deleteLike(O.act.key),B(O.act.key)):(O.act.liked=O.like.addLike(O.act.key,O.act.title,O.act.type),$(O.act)),j&&(T=M.collection("users").doc(j.uid),T.get().then((function(e){if(e.exists){O.app=new w(parseInt(O.act.key));let t=e.data().likes;if(O.act.liked=t.some(e=>e.key==O.act.key),O.act.liked){const e=t.findIndex(e=>e.key==O.act.key);t.splice(e,1),H(!1),O.act.liked=!1}else t.push({key:parseInt(O.act.key),title:O.act.title,type:O.act.type}),H(!0),O.act.liked=!0;T.set({likes:t})}else T.set({likes:[{key:parseInt(O.act.key),title:O.act.title,type:O.act.type}]})})).catch((function(e){console.error("Error al buscar documento:",e)}))),E(),f(y.main),A(O.act,O.act.liked)})():(e.target.matches("#generate, #generate *")||e.target.matches("#createAct, #createAct *"))&&(C(),y.activitySection.classList.contains("hidden")&&y.activitySection.classList.remove("hidden"))}),window.addEventListener("hashchange",(async function(){E(),f(y.main),g(y.main),y.activitySection.classList.contains("hidden")&&y.activitySection.classList.remove("hidden");const e=window.location.hash.replace("#","");if(O.app=new w(parseInt(e)),e>=1e6&&e<=9999999){try{const t=await O.app.getData();f(y.main),t?C(e,O.app.data):C(e)}catch(e){console.error("Something went wrong"),console.error(e)}y.activitySection.classList.contains("hidden")&&y.activitySection.classList.remove("hidden")}})),window.addEventListener("load",()=>{changeLanguageByButtonClick(),O.like=new x,window.location.hash="",O.like.readStorage(),O.like.likes.forEach(e=>$(e))})}]);