!function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){},function(e,t,i){"use strict";i.r(t);var a=i.p+"imgs/busywork.c8b68bdfbe524d73211081b9f13b0eef.svg",n=i.p+"imgs/charity.f15fc99644f13ad53879b4dfb5becf43.svg",s=i.p+"imgs/relaxation.fa1d5b6ddaf8b2511448a31a9ccfb08a.svg",c=i.p+"imgs/music.b7f3ce702efdb2d3c4baad72c5de3a92.svg",r=i.p+"imgs/social.90bbe0d86e1f00fd0666b954dd53983f.svg",l=i.p+"imgs/recreational.e584a76941cc7b156c5c7388892bc78c.svg",o=i.p+"imgs/diy.248c51205a09e739ca9975bf11621043.svg",d=i.p+"imgs/cooking.2059d863b5c2579c8fa31f243bbd0c54.svg",u=i.p+"imgs/education.b122915a224fb51bfa096624bb1a7de6.svg",h=i.p+"imgs/like-true.b61d119b5f76819c52f9d490178ad7cb.svg",y=i.p+"imgs/like-false.b00967356831f3bdc7c4529dc420ee5e.svg";const p={nav:document.querySelector("#nav"),menu:document.querySelector("#menu"),likes:document.querySelector("#likes"),activitySection:document.querySelector("#section1"),main:document.querySelector("#main"),likeToggle:document.querySelector("#like"),body:document.querySelector("#body"),whenSignedIn:document.getElementById("whenSignedIn"),whenSignedOut:document.getElementById("whenSignedOut"),signInBtn:document.getElementById("signInBtn"),signOutBtn:document.getElementById("signOutBtn"),userDetails:document.getElementById("userDetails"),createAct:document.getElementById("createAct"),actsList:document.getElementById("actsList"),newAct:document.getElementById("newAct")},m=e=>{let t;return t=e?h:y,t},k=e=>{let t;switch(e){case"busywork":t=a;break;case"charity":t=n;break;case"cooking":t=d;break;case"diy":t=o;break;case"education":t=u;break;case"music":t=c;break;case"recreational":t=l;break;case"relaxation":t=s;break;case"social":t=r;break;default:t=""}return t},f=e=>{e.insertAdjacentHTML("afterend",'\n    <svg id="loader" class="animate-spin my-10 mx-auto h-16 w-16 text-center text-primary-200" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n    <circle class="opacity-50" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n  </svg> \n    ')},g=()=>{const e=document.querySelector("#loader");e&&e.parentElement.removeChild(e)};class b{constructor(e="",t){this.key=e,this.data=t}async getResults(){if(null==this.data)try{const e=this.key&&""!==this.key&&!isNaN(this.key)?"https://bored-api.appbrewery.com/activity/"+this.key:"https://bored-api.appbrewery.com/activity",t=await fetch(e);if(!t.ok)return void(429===t.status?console.error("API rate limit exceeded. Please try again later."):console.error("HTTP error! status: "+t.status));const i=await t.json();return i.error?void console.error("API Error:",i.error):i.activity&&""!==i.activity?(this.title=i.activity,this.type=i.type,this.people=i.participants,this.price=i.price,this.link=i.link||"",this.access=i.accessibility,this.liked=!1,this.key=i.key,i):void console.error("Invalid API response: missing activity field")}catch(e){return void console.error("Error fetching activity:",e)}else this.title=this.data.title,this.type=this.data.type,this.people=this.data.people,this.price=this.data.price,this.link=this.data.link,this.access=this.data.access,this.liked=!!this.data.liked}}const v=firebase.firestore();class w{constructor(e){this.key=e}async getData(){const e=v.collection("activities").doc(""+this.key);try{const t=await e.get();return!!t.exists&&(this.data=t.data(),!0)}catch(e){return!1}}async updateLike(e){const t=v.collection("activities").doc(""+this.key);try{const i=await t.get();if(!i.exists)return!1;if(e)try{return await t.update({liked:i.data().liked+1}),!0}catch(e){return!1}else try{return await t.update({liked:i.data().liked-1}),!0}catch(e){return!1}}catch(e){return!1}}}class S{constructor(){this.likes=[]}addLike(e,t,i){const a={key:parseInt(e),title:t,type:i};return this.likes.push(a),this.persistData(),!0}deleteLike(e){const t=this.likes.findIndex(t=>t.key==e);return this.likes.splice(t,1),this.persistData(),!1}isLiked(e){return-1!==this.likes.findIndex(t=>t.key==e)}getLast(){return this.likes.length-1}persistData(){localStorage.setItem("likes",JSON.stringify(this.likes))}readStorage(){const e=JSON.parse(localStorage.getItem("likes"));e&&(this.likes=e)}}var x=i.p+"imgs/accesibility.68297b7bb8ebee64505429075ba45d46.svg",L=i.p+"imgs/price.369be4ac1120b25a6879b355281e713e.svg",I=i.p+"imgs/participants.a23b7c7aaece0ba39352ffcc61d60c6a.svg";const A=(e,t)=>{if(p.activitySection.classList.contains("hidden"))return;let i;i=null!=e&&null!=e.title?`     \n                  <div class="flex justify-between items-center ">\n              <h3 class="text-xl font-bold pl-6 capitalize"><a href="#${e.link||""}">${e.title}</a></h3>\n                  <div class="bg-primary-200 px-6 py-2 cursor-pointer" id="like">\n                      <img class="button hover:scale-110 " src="${m(t)}" alt="" srcset="">\n                  </div>\n              </div>\n              <div class="h-1 bg-primary-200"></div>\n                  <div class="font-semibold flex flex-col md:flex-row justify-evenly items-center p-3">            \n                      <h4>Categoria: <span class="font-bold capitalize">${e.type}</span></h4>\n                      <img src="${k(e.type)}" heigh="48" width="48">\n                      <h4>Participantes: <span class="font-bold">${e.people}</span></h4>\n                      <img src="${I}" heigh="48" width="48">\n                      <h4>Accesibilidad: <span class="font-bold">${Math.round(10*e.access)} / 10</span></h4>\n                      <img src="${x}" heigh="48" width="48">\n                      <h4>Precio: <span class="font-bold">${Math.round(10*e.price)} / 10</span></h4>\n                      <img src="${L}" heigh="48" width="48">\n                  </div>\n      `:null==e&&1==t?'<div class="bg-gray-400 h-full w-full text-center">\n    <h1 class="text-gray-800 font-extrabold p-6">Para activar la funcionalidad de me gustas, debe registrarse</h1>\n  </div>':'<div class="bg-red-700 h-full w-full text-center">\n    <h1 class="text-white font-extrabold p-6">Error: puede deberse a permisos, conexion o falta de data. Intente de vuelta</h1>\n  </div>',p.activitySection.insertAdjacentHTML("afterbegin",i)},E=()=>{p.activitySection.innerHTML=""},$=e=>{const t=`\n            <li>\n              <a href="#${e.key}" class="border-primary-300 border-2 flex flex-row px-6 py-4 justify-evenly">\n                <img src="${k(e.type)}" heigh="48" width="48">\n                <h4 class="text-base p-2">${e.title}</h4>\n              </a>\n            </li>`;p.likes.insertAdjacentHTML("beforeend",t)},B=e=>{if(e){const t=document.querySelector(`a[href*="${e}"]`).parentElement;t&&t.parentElement.removeChild(t)}};i(0);const O={},P=firebase.auth().currentUser,j=firebase.firestore();let M,T,C,q;const D=async(e,t)=>{const i=parseInt(e,10);O.act=new b((i||t)&&i||"",t),E(),g(p.main),f(p.main);try{await O.act.getResults()}catch(e){console.error(e)}if(null!=O.act.title){let e;P?(T=j.collection("users").doc(P.uid),e=await T.get().then(e=>e.data().likes.some(e=>e.key==O.act.key))):e=O.like.isLiked(O.act.key),g(p.main),A(O.act,e)}else E(),g(p.main),p.activitySection.classList.contains("hidden")||p.activitySection.classList.add("hidden"),i?(console.error("ERROR: Activity not found, try again"),O.act.liked=O.like.deleteLike(i),B(i)):console.error("ERROR: Could not fetch activity. The API may be rate-limited. Please try again in a moment.")},H=async e=>{if(O.app.key)try{await O.app.updateLike(e)}catch(e){console.error(e)}else console.error("Key not found")},N=firebase.default.auth(),R=new firebase.auth.GoogleAuthProvider;N.onAuthStateChanged(e=>{e?(p.whenSignedIn.hidden=!1,p.whenSignedOut.hidden=!0,p.userDetails.innerHTML=`<h2 id="${e.uid}">Hola <span class=" font-bold"> ${e.displayName}</span>!</h2><span>Para hacer <b>sync </b>de tus me gustas ponle me gusta a cualquier actividad!</p>`):(p.whenSignedIn.hidden=!0,p.whenSignedOut.hidden=!1,p.userDetails.innerHTML="")}),N.onAuthStateChanged(e=>{e?(T=j.collection("users").doc(e.uid),T.get().then((function(e){if(e.exists){let t=e.data().likes;T.set({likes:t}),O.like.likes.forEach(e=>B(e.key)),O.like.likes=t,O.like.likes.forEach(e=>$(e))}})).catch((function(e){console.error("Error al buscar documento:",e)})),M=j.collection("activities"),p.createAct.onclick=()=>{if(0!=p.newAct.elements.name.value){const t={key:1000001+q,uid:e.uid,uname:e.displayName,title:p.newAct.elements.name.value,type:p.newAct.elements.type.value,people:parseInt(p.newAct.elements.participants.value),price:p.newAct.elements.price.value/10,access:p.newAct.elements.accesibility.value/10,createdAt:firebase.firestore.FieldValue.serverTimestamp(),link:"",liked:0};D(t.key,t),M.doc(""+t.key).set(t),O.act.liked=O.like.addLike(t.key,t.title,t.type),$(O.act);for(let e=0;e<p.newAct.elements.length;e++)p.newAct.elements[e].value=""}},C=M.orderBy("createdAt").onSnapshot(e=>{q=e.docs.length;const t=e.docs.map(e=>`<li id="like-${e.data().key}"class="list-decimal list-inside flex flex-row items-center m-4 border-primary-200 p-4 border-4 rounded-lg bg-primary-300 text-white"><h4 class="mx-2 text-base"><a href="#${e.data().key}" class="font-bold cursor-pointer hover:scale-95">${e.data().title}- agregada por <span class="italic">${e.data().uname}</span></h4><div class="flex flex-col md:flex-row border-primary-200 border-2 rounded-md p-2 bg-primary-300 mx-3 my-0 cursor-pointer ml-auto" >\n\t\t\t\t\t<h4 class="text-3xl mx-2">${e.data().liked}</h4>\n\t\t\t\t\t<img class="button hover:scale-110 mx-2" src="${m(!0)}" alt="" srcset=""></img>\n\t\t\t\t</div></a> </li>`);p.actsList.innerHTML=t.join("")})):(O.app=null,C&&C())}),p.signInBtn.onclick=()=>N.signInWithPopup(R),p.signOutBtn.onclick=()=>{N.signOut(),O.like.likes.forEach(e=>B(e.key)),O.like=new S,window.location.hash="",O.like.readStorage(),O.like.likes.forEach(e=>$(e))},p.nav.addEventListener("click",e=>{e.target.matches("#likesBtn, #likesBtn *")?p.likes.classList.contains("hidden")?p.likes.classList.remove("hidden"):p.likes.classList.add("hidden"):e.target.matches("#burger, #burger *")&&(p.menu.classList.contains("hidden")?p.menu.classList.remove("hidden"):p.menu.classList.add("hidden"))}),p.body.addEventListener("click",e=>{e.target.matches("#like, #like *")?(async()=>{E(),g(p.main),f(p.main),O.like||(O.like=new S),O.like.isLiked(O.act.key)?(O.act.liked=O.like.deleteLike(O.act.key),B(O.act.key)):(O.act.liked=O.like.addLike(O.act.key,O.act.title,O.act.type),$(O.act)),P&&(T=j.collection("users").doc(P.uid),T.get().then((function(e){if(e.exists){O.app=new w(parseInt(O.act.key));let t=e.data().likes;if(O.act.liked=t.some(e=>e.key==O.act.key),O.act.liked){const e=t.findIndex(e=>e.key==O.act.key);t.splice(e,1),H(!1),O.act.liked=!1}else t.push({key:parseInt(O.act.key),title:O.act.title,type:O.act.type}),H(!0),O.act.liked=!0;T.set({likes:t})}else T.set({likes:[{key:parseInt(O.act.key),title:O.act.title,type:O.act.type}]})})).catch((function(e){console.error("Error al buscar documento:",e)}))),E(),g(p.main),A(O.act,O.act.liked)})():(e.target.matches("#generate, #generate *")||e.target.matches("#createAct, #createAct *"))&&(D(),p.activitySection.classList.contains("hidden")&&p.activitySection.classList.remove("hidden"))}),window.addEventListener("hashchange",(async function(){const e=window.location.hash.replace("#","").trim();if(!e||""===e)return E(),g(p.main),void(p.activitySection.classList.contains("hidden")||p.activitySection.classList.add("hidden"));const t=parseInt(e,10);if(isNaN(t)||t<1e6||t>9999999)return E(),g(p.main),void(p.activitySection.classList.contains("hidden")||p.activitySection.classList.add("hidden"));E(),g(p.main),f(p.main),p.activitySection.classList.contains("hidden")&&p.activitySection.classList.remove("hidden"),O.app=new w(t);try{const e=await O.app.getData();g(p.main),e?D(t,O.app.data):D(t)}catch(e){console.error("Something went wrong"),console.error(e),g(p.main),p.activitySection.classList.contains("hidden")||p.activitySection.classList.add("hidden")}})),document.addEventListener("DOMContentLoaded",()=>{p.activitySection&&!p.activitySection.classList.contains("hidden")&&p.activitySection.classList.add("hidden"),E()}),window.addEventListener("load",()=>{changeLanguageByButtonClick(),O.like=new S,E(),g(p.main),p.activitySection&&!p.activitySection.classList.contains("hidden")&&p.activitySection.classList.add("hidden");const e=window.location.hash.replace("#","").trim();if(e&&""!==e){const t=parseInt(e,10);(isNaN(t)||t<1e6||t>9999999)&&(window.location.hash="")}else window.location.hash="";O.like.readStorage(),O.like.likes.forEach(e=>$(e))})}]);
//# sourceMappingURL=main.30a3dbd2e083b8a4cb4f.js.map